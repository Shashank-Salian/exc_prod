import{B as b,o as a,c as x,i as A,h as c,p as U,e as j,I as E,b as g,S as B,r as v}from"./utils-609fe6b6.js";import{u as J,C as y,N as F}from"./Nav-9f1167dd.js";const O="_container_5nrm8_1",q="_profileContainer_5nrm8_11",H="_avatarContainer_5nrm8_23",L="_inpContainer_5nrm8_47",M="_inp_5nrm8_47",T="_card_5nrm8_63",z="_listContainer_5nrm8_71",G="_list_5nrm8_71",K="_lhs_5nrm8_109",Q="_icon_5nrm8_123",R="_nameContainer_5nrm8_131",W="_name_5nrm8_131",X="_desc_5nrm8_153",Y="_message_5nrm8_163",Z="_avatars_5nrm8_189",t={container:O,profileContainer:q,avatarContainer:H,inpContainer:L,inp:M,card:T,listContainer:z,list:G,lhs:K,icon:Q,nameContainer:R,name:W,desc:X,message:Y,avatars:Z},aa=()=>{if(!__userData)return location.pathname="/",a("span",{children:"Something wen't wrong"});const i=[{id:"userName",type:"text",isValid:()=>i[0].value.length>=2,value:__userData.name,placeholder:"Name"},{id:"userUsername",type:"text",isValid:()=>x(i[1].value),value:__userData.username,placeholder:"Username"},{id:"userEmail",type:"email",isValid:()=>A(i[2].value),value:__userData.email,placeholder:"Email"},{id:"userPassword",type:"password",isValid:()=>i[3].value.length>=8,value:"",placeholder:"Old password"},{id:"userNewPassword",type:"password",isValid:()=>i[4].value.length>=8,value:"",placeholder:"New password"}],[r,f]=c(i),[u,C]=c(null),[o,m]=c(null),[N,p]=c(!1),[h,S]=c(parseInt(__userData.avatar.match(/\d+/g)[0])),w=async()=>{try{const n=await(await v("/api/community/mycommunities/")).json();if(n.ok){C(n.data);return}alert(n.message)}catch(e){console.error(e),alert("Something went wrong")}},$=async e=>{if(confirm("Are you sure you want to leave this community?"))try{if((await(await v(`/api/community/leave/${e}/`)).json()).ok){await w();return}}catch(n){console.error(n),alert("Something went wrong while leaving the community")}},D=e=>{S(e),p(!1)};U(()=>{w()},[]),J(a(y,{heading:"Select your Avatar :",boldHead:!0,children:a("div",{className:t.avatars,children:j.map(e=>a("img",{width:"100px",height:"100px",src:`/static/imgs/p${e}.jpg`,alt:`Person ${e}`,className:"lite-shadow",onClick:()=>D(e)},e))})}),{show:N,onBackdropClick:()=>p(!1)});const k=()=>{p(!0)},P=(e,n)=>{f(l=>{const d=[...l];return d[n].value=e.currentTarget.value,d})},I=async()=>{const[e,n,l,d,V]=[...r];if(![e,n,l].every(s=>s.isValid())){m({message:"Every field must be valid",type:"error"});return}if(V.value!==""){if(d.value===""){m({message:"Old password cannot be empty",type:"error"});return}if(!confirm("Updating password will log you out. Are you sure ?"))return}try{const s=new FormData;__userData.name!==r[0].value&&s.append("fullName",r[0].value),__userData.username!==r[1].value&&s.append("username",r[1].value),__userData.email!==r[2].value&&s.append("email",r[2].value),r[3].value!==""&&s.append("oldPassword",r[3].value),r[3].value!==""&&s.append("newPassword",r[4].value),parseInt(__userData.avatar.match(/\d+/g)[0])!==h&&s.append("avatar",h.toString());const _=await(await v("/api/users/update/",s,"POST")).json();if(_.ok){m({message:_.message,type:"success"}),location.reload();return}m({message:_.message,type:"error"})}catch(s){console.log(s),alert("Something went wrong while updating your profile")}};return a("div",{className:`main ${t.container}`,children:[a(F,{}),a("div",{className:"pad container",children:[a("h2",{children:"Profile :"}),a("div",{className:`mt-20 ${t.profileContainer}`,children:[a("div",{children:[a("div",{className:`${t.avatarContainer}`,children:[a("img",{src:`/static/imgs/p${h}.jpg`,width:"150px",height:"150px",className:"lite-shadow",onClick:k}),a("h3",{className:"mt-20",children:__userData.name})]}),a("h4",{className:"mt-20 mb-10",children:"Edit :"}),a("div",{className:t.inpContainer,children:r.map((e,n)=>a(E,{id:e.id,type:e.type,placeholder:e.placeholder,name:`form-${e.id}`,required:!0,value:e.value,onInput:l=>P(l,n),isValid:e.isValid(),disabled:e.type==="email",className:`mt-30 ${t.inp}`},n))}),a("p",{className:`mt-10 mb-10 ${t.message}`,"data-type":o==null?void 0:o.type,children:o==null?void 0:o.message}),a(g,{onClick:I,children:"Update"})]}),a("div",{children:a(y,{className:t.card,noMargin:!0,heading:"Communities Joined :",boldHead:!0,color:"yellow",children:a("ul",{className:t.listContainer,children:u===null?a(B,{}):u.length===0?a("h3",{children:"No communities joined"}):u.map((e,n)=>a("li",{children:[a("div",{className:`mb-10 mt-10 ${t.list}`,children:[a("a",{href:`/x/${e.name}`,className:`mr-20 ${t.lhs}`,children:[a("img",{src:e.iconPath,alt:e.name,width:"40px",height:"40px",className:`mr-10 ${t.icon}`}),a("div",{className:t.nameContainer,children:[a("span",{className:t.name,children:e.name}),a("span",{className:t.desc,children:e.topic})]})]}),a("span",{children:a(g,{color:"red",onClick:()=>$(e.name),children:"Leave"})})]}),a("hr",{})]},n))})})})]})]})]})};b(a(aa,{}),document.getElementById("root"));
