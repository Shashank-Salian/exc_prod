import{h as m,_ as y,p as f,o as a,S as v,b as g,r as l,B as C}from"./utils-f1dc011d.js";import{u as D,P as N,C as P,N as $}from"./Nav-31bd0bdf.js";import{u as k,P as j}from"./usePagination-e9690c7a.js";import"./MarkdownEditor.module-37fbe7f1.js";const S="_container_lx541_1",x="_main_lx541_11",B={container:S,main:x},J="_container_1u6ph_1",L="_headContainer_1u6ph_13",q="_x_1u6ph_25",b="_left_1u6ph_33",E="_right_1u6ph_45",I="_icon_1u6ph_53",A="_participants_1u6ph_69",H="_desc_1u6ph_93",R="_joinBtn_1u6ph_103",T="_pad_1u6ph_113",o={container:J,headContainer:L,x:q,left:b,right:E,icon:I,participants:A,desc:H,joinBtn:R,pad:T},F=({data:t})=>{const[d,p]=m([]),[_,c]=m(!1),[w,r]=m(!1),h=y(1),i=async()=>{try{r(!0),c(!0);const n=await(await l(`/api/community/posts/${t.name}/?page=${h.current}`)).json();if(c(!1),console.log(n),n.ok){if(n.code==="END_OF_PAGE"){r(!0);return}r(!1),p(e=>[...e,...n.data]);return}r(!1),alert("Couldn't fetch posts")}catch(s){r(!1),c(!1),console.error(s),alert("Couldn't fetch posts, something went wrong!")}};return f(()=>{i()},[]),k(null,100,()=>{h.current++,i()},w),a("div",{className:`${o.container} drop-shadow`,children:[a(G,{data:t}),a("div",{className:o.pad,children:[a("h2",{children:"Posts :"}),d.length===0?_?a("div",{className:"flx-c",children:a(v,{})}):a("h1",{className:"mt-40",style:{textAlign:"center"},children:"No posts found"}):d.map(s=>a(j,{postData:s},s.id))]})]})},G=({data:t})=>{const[d,p]=m([]),[_,c]=m(!1),w=async()=>{try{const e=await(await l(`/api/community/leave/${t.name}/`)).json();if(e.ok){alert(e.message),location.reload();return}alert(e.message)}catch(n){console.error(n),alert("Something wen't wrong")}},r=async()=>{try{const e=await(await l(`/api/community/join/${t.name}/`)).json();if(e.ok){location.reload();return}alert(e.message)}catch(n){console.error(n),alert("Something wen't wrong")}},h=async()=>{try{const e=await(await l(`/api/community/participants/${t.name}/`)).json();if(e.ok){p(e.data),c(!0);return}alert(e.message)}catch(n){console.error(n),alert("Something wen't wrong")}},i=()=>{c(!1)},s=async n=>{console.log(n);try{const u=await(await l(`/api/community/removeparticipant/${t.name}?user=${n}`)).json();if(u.ok){alert(u.message),p(u.data);return}alert(u.message)}catch(e){console.error(e),alert("Something wen't wrong")}};return D(a(P,{fw:!0,heading:"Participants :",boldHead:!0,icon:"close",onIconClick:i,children:a(N,{items:d.map(n=>({name:n.username,icon:n.avatar,desc:n.name,link:`/s/${n.username}`,rhs:t.moderator===n.username?"M":t.moderator===(__userData==null?void 0:__userData.username)?a(g,{color:"red",onClick:()=>s(n.username),children:"Remove"}):void 0}))})}),{show:_,onBackdropClick:i}),a("div",{className:`${o.headContainer} ${o.pad} lite-shadow`,children:[a("div",{className:o.left,children:[a("div",{className:"mr-20",children:a("img",{className:`${o.icon} lite-shadow`,src:t.iconPath,alt:t.name})}),a("div",{className:"mr-20",children:[a("div",{children:[a("h2",{children:[a("span",{className:o.x,children:"x/"}),t.name]}),a("span",{children:["Topic : ",a("span",{style:{fontWeight:"600"},children:t.topic})]})]}),a("p",{className:`mt-10 ${o.desc}`,children:t.description})]})]}),a("div",{className:o.right,children:[a(g,{onClick:h,color:"transp",className:`${o.participants} mr-20`,children:[a("span",{children:"participants"}),a("h2",{children:t.participantsCount})]}),a("div",{children:a(g,{className:o.joinBtn,color:t.userJoined?"red":void 0,onClick:t.userJoined?w:r,children:t.userJoined?"Leave":"Join"})})]})]})},M=()=>__communityData?(console.log(__communityData),f(()=>{document.title=__communityData.name},[]),a("div",{className:`${B.container} main`,children:[a($,{}),a("main",{className:"container pad",children:[a("h2",{className:"mb-30",children:"Community :"}),a(F,{data:__communityData})]})]})):a("span",{children:"Community not found or internal server error"});C(a(M,{}),document.getElementById("root"));
